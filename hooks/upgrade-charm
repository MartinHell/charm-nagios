#!/bin/sh
set -e
legacy_relations="`relation-ids legacy`"
if [ -n "$legacy_relations" ] ; then
    juju-log -l WARNING 'Relations have been radically changed. The monitoring interface is not supported anymore.'
    juju-log -l WARNING 'Please use the generic juju-info or the monitors interface'
fi
if [ -n "`config-get extraconfig`" ] ; then
    config-get extraconfig > /etc/nagios3/conf.d/extra.cfg
else
    rm -f /etc/nagios3/conf.d/extra.cfg
fi
# Refresh these hooks entirely
hooks/mymonitors-relation-joined
hooks/monitors-relation-changed
